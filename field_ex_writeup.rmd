---
bibliography: ex_writeup.bib
csl: ecology.csl
output: pdf_document
---
## Implications of habitat-mediated density dependence in Crawfish Frogs (*Lithobates areolatus*)

## Auriel M.V. Fournier
## Population Ecology
## Spring 2015

## Background

Density dependence, if it exists, is very important in understanding the population ecology of a species. While there are some exceptions (the Allee effect) where a minimum viable population is important, often lower density populations have higher individual survival. Density dependence is often not the only factor impacting survival of a population, or a certain part of a population, environmental variables can also play a huge role. Either by releasing a segment of the population from the limting factors creating density dependence, or by making the limiting factors more limiting, or adding additional limitations. This coudl be done by providing additional food, or additional shelter or by introducting new predators, removing shelter or adding new chemicals into the environment that limit growth or survival. These relationships have been examined in many invertebrates, but species with longer life spans can have similar mechanisms but they are more difficult to tease apart. Amphibians provide a good vertebrate model organism because they have a fairly quick life cycle and the parts of their life cycle where they are thought to experience density dependence are fairly short (several weeks/months) instead of years as in larger longer lived organisms or organisms with different reproductive strategies. These ideas have been examined in several life stages (eggs [@Vonesh2002] (aquatic alrval and terrestrial juvenile stages [@Altwegg2003] (juvenile terestrial stage [@Harper2007] but not often in differening habitat conditions. Though Patrick et al [-@Patrick2008] did exampine habitat and density dependence in wood frogs (*Rana sylvatica*) in relation to environmental covariates which could play a role by limiting growth or resources and incuding density dependence at densities where it would not occur under 'ideal' or 'typical' conditions. 

We are looking at a variety of densities and four different habitat/vegetation scenarios to examine the role of restored versus unrestored wetland habitats and native vs invasive (fescue) vegetation. Non-restored habitats or those with non-native vegetation might not provide sufficient resources for the individuals or may create a more stressful environment by having different chemical or other triggers of stress (CITATION). 

UV impacts on density dependence [@Blaustein2003]

overcoming density depenedce and insecticides [@Boone2005]

## Experimental Design

We created four rafts of mesocosms to be deployed at Woolsey Wet Prarie, a local restored wetland in Fayetteville, AR. TWo rafts were deployed in the restored wetland portion of Woolsey, and two in the farm pond portion of woolsey. Each raft in the pond habitat was given fescue grass (a non-native grass that grows around the ponds) and the restored wetland areas were given native prarie grass (collected from the restored area). The following densities were repeated across the two rafts(1,3,6,21,24,48 tadpoles). We selected these two plant communities to see if the non-native fescue grass has a different impact on tadpole density then the native prarie grass. We choose densities across a wide range (1-48) to ensure that we picked densites extreme enough to be able to determine if there are density dependence effects. 

Our responses are both survival and growth. To measure survival the mesocosms are checked at regular intervals and individuals in each mesocosm are counted. Growth was measured by assessing the size and weight of tadpoles at regular intervals. We predict that there will be density dependence, and that fescue grass will have more negative density dependence then prarie grass because it exudes chemicals which impact tadpoles. We predict that tadpoles will grow better and be less susceptible to density dependence in teh restored wetladn then the farm pond. 

## Model Description

We were given some possible data to use in our model and used the script provided by Dr. Willson to obtain the gamma and density dependent scaling factor for each habitat type. We did this by varying the d and gamma values across a wide range, comparing the line to the possible values and finding the combination of values which had the lowest residuals (straight line distance along the y axis). 

```{r results='asis', echo=FALSE}
library(xtable)
header <- c("Variable","pond","prairie")
dd <- c("density dependent scaling factor",0.0059059, 0.007007007)
gamma <- c("gamma", 1.20, 0.94)

df <- rbind(dd, gamma)
colnames(df) <- header

print(xtable(df, comment=FALSE,caption="Results from Possible Data Model"), comment=FALSE, caption.placement="top")

```

I used these values in the time series model to look at the impacts of these variables on population growth as a whole. Our model is a time series model and allows a parameter in the matrix to change with each time step. We are allowing the Fecundity of adults paramter to vary, which is a function of the number of tadpoles, their survival and the number of adults. 


## Results

## Discussion

## Figures

```{r, echo=FALSE}
phi = 5000
se = .6
sm = .2
sj = .2
sa = .75
stmax = .8
p = .5
d = .0007007007
gamma = .94
tmax = 200


NGr <- matrix(nrow=2,ncol=tmax)
NGr[,1] <- 1


for(t in 2:tmax){
tt = NGr[2,t-1] * p * phi * se
st = (stmax)/((1+d*tt)^gamma)
ft = p * phi * se * st * sm
mat <- matrix(c(0,sj,ft,sa),ncol=2, nrow=2)
newN <- mat %*% NGr[,t-1]
NGr[,t] <- newN
}


####

## Sensativity

####


phi = 5000
se = .6
sm = .2
sj = .2
sa = seq(0,1,by=.01)
stmax = .8
p = .5
d = .0007007007
gamma = .94
tmax = 1000

mat <- matrix(c(0,sj,ft,sa),ncol=2, nrow=2)

NGr <- matrix(nrow=2,ncol=tmax)
NGr[,1] <- 1

savadGr <- matrix(ncol=2, nrow=length(sa))
savadGr[,1] <- sa

for(i in 1:length(sa)){
	for(t in 2:tmax){
		tt = NGr[2,t-1] * p * phi * se
		st = (stmax)/((1+d*tt)^gamma)
		ft = p * phi * se * st * sm
		mat <- matrix(c(0,sj,ft,sa[i]),ncol=2, nrow=2)
		newN <- mat %*% NGr[,t-1]
		NGr[,t] <- newN
	}
savadGr[i,2] <- newN[2,]
}




###

## egg survival

###


phi = 5000
se = seq(0,1,by=.01)
sm = .2
sj = .2
sa = .75
stmax = .8
p = .5
d = .0007007007
gamma = .94
tmax = 1000

mat <- matrix(c(0,sj,ft,sa),ncol=2, nrow=2)

NGr <- matrix(nrow=2,ncol=tmax)
NGr[,1] <- 1

saveggGr <- matrix(ncol=2, nrow=length(se))
saveggGr[,1] <- se

for(i in 1:length(se)){
	for(t in 2:tmax){
		tt = NGr[2,t-1] * p * phi * se[i]
		st = (stmax)/((1+d*tt)^gamma)
		ft = p * phi * se[i] * st * sm
		mat <- matrix(c(0,sj,ft,sa),ncol=2, nrow=2)
		newN <- mat %*% NGr[,t-1]
		NGr[,t] <- newN
	}
saveggGr[i,2] <- newN[2,]
}




```



```{r, echo=FALSE}
phi = 5000
se = .6
sm = .2
sj = .2
sa = .75
stmax = .8
p = .5
d = .0059059
gamma = 1.20
tmax = 200


NPo <- matrix(nrow=2,ncol=tmax)
NPo[,1] <- 1


for(t in 2:tmax){
tt = NPo[2,t-1] * p * phi * se
st = (stmax)/((1+d*tt)^gamma)
ft = p * phi * se * st * sm
mat <- matrix(c(0,sj,ft,sa),ncol=2, nrow=2)
newN <- mat %*% NPo[,t-1]
NPo[,t] <- newN
}


####

## Sensativity

####


phi = 5000
se = .6
sm = .2
sj = .2
sa = seq(0,1,by=.01)
stmax = .8
p = .5
d = .0059059
gamma = 1.20
tmax = 1000

mat <- matrix(c(0,sj,ft,sa),ncol=2, nrow=2)

NPo <- matrix(nrow=2,ncol=tmax)
NPo[,1] <- 1

savadPo <- matrix(ncol=2, nrow=length(sa))
savadPo[,1] <- sa

for(i in 1:length(sa)){
  for(t in 2:tmax){
		tt = NPo[2,t-1] * p * phi * se
		st = (stmax)/((1+d*tt)^gamma)
		ft = p * phi * se * st * sm
		mat <- matrix(c(0,sj,ft,sa[i]),ncol=2, nrow=2)
		newN <- mat %*% NPo[,t-1]
		NPo[,t] <- newN
	}
savadPo[i,2] <- newN[2,]
}




###

## egg survival

###


phi = 5000
se = seq(0,1,by=.01)
sm = .2
sj = .2
sa = .75
stmax = .8
p = .5
d = .0059059
gamma = 1.20
tmax = 1000

mat <- matrix(c(0,sj,ft,sa),ncol=2, nrow=2)

NPo <- matrix(nrow=2,ncol=tmax)
NPo[,1] <- 1

saveggPo <- matrix(ncol=2, nrow=length(se))
saveggPo[,1] <- se

for(i in 1:length(se)){
	for(t in 2:tmax){
		tt = NPo[2,t-1] * p * phi * se[i]
		st = (stmax)/((1+d*tt)^gamma)
		ft = p * phi * se[i] * st * sm
		mat <- matrix(c(0,sj,ft,sa),ncol=2, nrow=2)
		newN <- mat %*% NPo[,t-1]
		NPo[,t] <- newN
	}
saveggPo[i,2] <- newN[2,]
}





```

```{r, echo=FALSE, fig.height=4}
plot(seq(1:tmax), NGr[2,], main="initial model", xlab="time", ylab="population size", col="black")
points(seq(1:tmax),NPo[2,], col="red")
```

**Figure 1 - Our initial population model using the parameters given to us in class**

```{r, echo=FALSE, fig.height=4}
par(mfrow=c(1,2))
plot(saveggGr,  xlab="survival of eggs", ylab="population size")
points(saveggPo, col="purple")
plot(savadGr,  xlab="survival of adults", ylab="population size", ylim=c(0,10000))
points(savadPo, col="purple")
```

**Figure  - Sensativity Analysis of egg and adult survival in each habitat type (y scale on adult graph shortened to allow for visual interpretation of results**

## References

